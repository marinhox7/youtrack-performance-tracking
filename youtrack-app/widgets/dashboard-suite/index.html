<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Performance Dashboard Suite</title>
    <style>
        * {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif !important;
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body, html {
            margin: 0;
            padding: 0;
            background: #ffffff;
            color: #333333;
            font-size: 13px;
            line-height: 1.4;
        }

        .dashboard-container {
            padding: 16px;
            max-width: 100%;
            overflow-x: auto;
        }

        .dashboard-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            padding-bottom: 16px;
            border-bottom: 1px solid #e5e5e5;
        }

        .dashboard-title {
            font-size: 18px;
            font-weight: 600;
            color: #333;
            margin: 0;
        }

        .refresh-button {
            background: #0066cc;
            color: white;
            border: none;
            border-radius: 4px;
            padding: 8px 16px;
            font-size: 12px;
            cursor: pointer;
            transition: background-color 0.2s;
        }

        .refresh-button:hover {
            background: #0052a3;
        }

        .refresh-button:disabled {
            background: #cccccc;
            cursor: not-allowed;
        }

        .loading {
            text-align: center;
            padding: 40px 20px;
            color: #666;
        }

        .error {
            background: #fff2f2;
            border: 1px solid #ffc6c6;
            color: #cc0000;
            padding: 12px;
            border-radius: 4px;
            margin-bottom: 16px;
            font-size: 12px;
        }

        .metrics-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 16px;
            margin-bottom: 24px;
        }

        .metric-card {
            background: #f8f9fa;
            border: 1px solid #e5e5e5;
            border-radius: 6px;
            padding: 16px;
            text-align: center;
            transition: box-shadow 0.2s;
        }

        .metric-card:hover {
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }

        .metric-value {
            font-size: 24px;
            font-weight: 700;
            color: #333;
            margin-bottom: 4px;
        }

        .metric-label {
            font-size: 11px;
            color: #666;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            font-weight: 500;
        }

        .hidden {
            display: none;
        }
    </style>
</head>
<body>
    <div class="dashboard-container">
        <div class="dashboard-header">
            <h1 class="dashboard-title">Performance Dashboard</h1>
            <button class="refresh-button" id="refreshBtn" onclick="loadData()">
                Atualizar
            </button>
        </div>

        <div id="loading" class="loading">
            Carregando dados...
        </div>

        <div id="error" class="error hidden">
            <!-- Mensagens de erro aparecer√£o aqui -->
        </div>

        <div id="content" class="hidden">
            <div class="metrics-grid" id="metricsGrid">
                <!-- Cards de m√©tricas aparecer√£o aqui -->
            </div>
        </div>
    </div>

    <script>
        console.log('üöÄ Performance Dashboard inicializando...');

        // Estado global do dashboard
        let dashboardData = {
            issues: [],
            metrics: {}
        };

        // Fun√ß√£o para mostrar loading
        function showLoading(show = true) {
            const loading = document.getElementById('loading');
            const content = document.getElementById('content');
            const refreshBtn = document.getElementById('refreshBtn');

            if (show) {
                loading.classList.remove('hidden');
                content.classList.add('hidden');
                refreshBtn.disabled = true;
                refreshBtn.textContent = 'Carregando...';
            } else {
                loading.classList.add('hidden');
                content.classList.remove('hidden');
                refreshBtn.disabled = false;
                refreshBtn.textContent = 'Atualizar';
            }
        }

        // Fun√ß√£o para mostrar erro
        function showError(message) {
            const errorDiv = document.getElementById('error');
            errorDiv.textContent = message;
            errorDiv.classList.remove('hidden');
        }

        // Fun√ß√£o para esconder erro
        function hideError() {
            document.getElementById('error').classList.add('hidden');
        }

        // Fun√ß√£o principal para carregar dados
        async function loadData() {
            console.log('üìä Carregando dados do dashboard...');

            showLoading(true);
            hideError();

            try {
                // Por enquanto, vamos usar dados de exemplo
                const exampleData = generateExampleData();

                dashboardData.issues = exampleData;
                calculateMetrics();
                renderDashboard();

                console.log('‚úÖ Dashboard carregado com sucesso');

            } catch (error) {
                console.error('‚ùå Erro ao carregar dashboard:', error);
                showError('Erro ao carregar dados: ' + error.message);
            } finally {
                showLoading(false);
            }
        }

        // Gerar dados de exemplo
        function generateExampleData() {
            console.log('üìù Gerando dados de exemplo...');

            const data = [];
            const states = ['Aberto', 'Em Progresso', 'Resolvido', 'Fechado'];

            for (let i = 1; i <= 20; i++) {
                data.push({
                    id: i.toString(),
                    idReadable: `DEMO-${i}`,
                    state: { name: states[Math.floor(Math.random() * states.length)] },
                    created: Date.now() - (Math.random() * 30 * 24 * 60 * 60 * 1000),
                    priority: { name: ['Baixa', 'M√©dia', 'Alta', 'Cr√≠tica'][Math.floor(Math.random() * 4)] }
                });
            }

            return data;
        }

        // Calcular m√©tricas
        function calculateMetrics() {
            console.log('üî¢ Calculando m√©tricas...');

            const issues = dashboardData.issues;
            const total = issues.length;

            const resolved = issues.filter(issue => {
                const state = (issue.state?.name || '').toLowerCase();
                return state.includes('resolvido') || state.includes('fechado');
            }).length;

            const active = total - resolved;
            const completionRate = total > 0 ? Math.round((resolved / total) * 100) : 0;

            dashboardData.metrics = {
                total,
                resolved,
                active,
                completionRate
            };

            console.log('üìä M√©tricas calculadas:', dashboardData.metrics);
        }

        // Renderizar dashboard
        function renderDashboard() {
            console.log('üé® Renderizando dashboard...');
            renderMetrics();
        }

        // Renderizar m√©tricas
        function renderMetrics() {
            const metrics = dashboardData.metrics;
            const grid = document.getElementById('metricsGrid');

            grid.innerHTML = `
                <div class="metric-card">
                    <div class="metric-value">${metrics.total}</div>
                    <div class="metric-label">Total de Issues</div>
                </div>
                <div class="metric-card">
                    <div class="metric-value">${metrics.resolved}</div>
                    <div class="metric-label">Issues Resolvidas</div>
                </div>
                <div class="metric-card">
                    <div class="metric-value">${metrics.active}</div>
                    <div class="metric-label">Issues Ativas</div>
                </div>
                <div class="metric-card">
                    <div class="metric-value">${metrics.completionRate}%</div>
                    <div class="metric-label">Taxa de Conclus√£o</div>
                </div>
            `;
        }

        // Inicializar dashboard quando a p√°gina carregar
        document.addEventListener('DOMContentLoaded', function() {
            console.log('üåü DOM carregado, inicializando dashboard...');
            loadData();
        });

        console.log('‚úÖ Performance Dashboard configurado');
    </script>
</body>
</html>